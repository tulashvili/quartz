---
title: Как подключиться по ssh от root-пользователя
draft: false
tags:
  - dictionary/linux
date: 2024-09-14
updated: 2025-02-01T13:12
---
Вот реально бесячая для меня тема. Раз в пару месяцев убиваю кучу времени, чтобы вспомнить, как это сделать.

Поэтому давай-ка закрепим это раз и навсегда: значит есть у нас сервер. Ты уже заходил на него определенное количество раз после того, как закупил его у хостера. Ну значит ключ ты уже туда свой прокинул и пароль вводил максимум один раз - при первой авторизации.

А теперь тебя приспичило настроить себе VPN на этом сервере. Настроил значит ты VPN, но теперь надо передать на свой локальный хост два файла: `ca.crt` и `myclient1.crt`

Пытаешься под обычным юзером с локального хоста закинуть эти файлы, но получаешь по лицу:
```
sudo scp ubuntu@51.68.220.172:/home/ubuntu/ca.crt .
ubuntu@51.68.220.172's password: 
Permission denied, please try again.
ubuntu@51.68.220.172's password:
```

Пароль я свой, конечно же, не поменял при первом входе для пользователя `ubuntu`. Ок, значит пробуем под рутом и тут тоже облом:
```
scp root@51.68.220.172:/home/ubuntu/ca.crt .  
root@51.68.220.172's password: 
Permission denied, please try again.
```

- Идем на сервер по ssh
- Логинемся там под рутом через `sudo su`
- Меняем пароль:
```
passwd
```
Записываем его куда-нибудь, он еще понадобится

ТЕПЕРЬ САМОЕ ГЛАВНОЕ!
```
vim /etc/ssh/sshd_config
```
- Внутри:
```
PasswordAuthentication yes
PermitRootLogin yes
```
- Затем:
```
systemctl restart sshd
```

- Пробуем снова с локального хоста подключиться:
```
scp root@51.68.220.172:/home/ubuntu/ca.crt .
```
Вводим пароль для `root`, который мы записали и вуаля, все работает.

Мы молодцы!
![gif](https://media1.giphy.com/media/NfzERYyiWcXU4/giphy.gif?cid=16a6abc24gn30nj69vjp5d4jgurfhjp84a78d587299lk50i&ep=v1_gifs_search&rid=giphy.gif&ct=g)

